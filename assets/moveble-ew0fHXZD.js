import{d as I,r as h,p as H,o as w,b as _,e as d,F as D,q as P,k as N,n as B,t as j,f as z,u as O,s as T,_ as J,a as y,l as K,c as b,w as E,m as V,g as S}from"./index-DTPxENS2.js";import{f as q}from"./style-CPRuMVO8.js";import{M as A}from"./moveable-hF_l2l2E.js";const Z={class:"container"},G=["id","data-id","data-left","data-top","onMousedown"],Q=!0,X=I({__name:"moveble",props:{scale:{},snapsObj:{},shadow:{}},emits:["update:shadow","update:snapsObj"],setup(L,{emit:p}){const g=p,f=h(null),r=h(null),k={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},o={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},v=h(),i=h([{id:"target0",className:"element0",left:200,top:150,background:"#ee8",width:600,zIndex:1,height:600},{id:"target1",className:"element1",left:600,top:150,zIndex:1,background:"rgb(52, 55, 221)",width:400,height:300},{id:"target2",className:"element2",left:100,top:600,zIndex:1,background:"rgb(212, 67, 152)",width:400,height:400}]),x=(e,c)=>{const t=c.id;i.value.forEach(u=>u.zIndex=1),c.zIndex=2,f.value=t,T(()=>{r.value.dragStart(e)})},l=e=>{v.value=JSON.parse(JSON.stringify(i.value))},a=e=>{let{target:c,translate:t}=e;const{id:u}=c.dataset,{left:$,top:R,width:M,height:U}=v.value.find(C=>C.id==u),[W,F]=t,m=i.value.find(C=>C.id==u);m.left=$+W,m.top=R+F,g("update:shadow",{x:m.left,y:m.top,width:M,height:U})};H(()=>i,()=>{const e=i.value.map(t=>t.top),c=i.value.map(t=>t.left);g("update:snapsObj",{h:e,v:c})},{deep:!0});const s=e=>({left:e.left+"px",top:e.top+"px",lineHeight:e.height+"px",width:e.width+"px",height:e.height+"px",zIndex:e.zIndex,transform:"rotate(0deg)",background:e.background}),n=e=>{r.value.updateRect()};return(e,c)=>(w(),_(D,null,[d("div",Z,[(w(!0),_(D,null,P(i.value,t=>(w(),_("div",{id:t.id,key:t.id,class:N(["target",t.className]),"data-id":t.id,"data-left":t.left,"data-top":t.top,style:B(s(t)),onMousedown:u=>x(u,t)},j(t.className),47,G))),128))]),z(O(A),{ref_key:"moveableRef",ref:r,snappable:!0,"snap-gap":!0,"snap-directions":k,"element-snap-directions":o,"snap-threshold":5/e.scale,target:`#${f.value}`,draggable:Q,"element-guidelines":[".container",".element0",".element1",".element2"],onDrag:a,onDragStart:l,onDragEnd:n},null,8,["snap-threshold","target"])],64))}}),Y=J(X,[["__scopeId","data-v-9639060f"]]),ee={class:"demo"},te={class:"top font16"},ae={class:"scale mr10"},se={class:"btns"},ne=["onClick"],oe=["onClick"],le=["onClick"],ce=I({__name:"moveble",setup(L){const p=h(),g=y({maxScale:3,minScale:.3,disablePan:!1,disableZoom:!1,contain:"none",handleStartEvent:l=>{l.preventDefault(),console.log("handleStartEvent",l)}}),f=h(!1);K(()=>{const l=p.value.panzoomInstance,a=document.getElementsByClassName("canvasedit-parent");if(a[0]){const s=a[0];s&&s.addEventListener("wheel",function(n){(n.ctrlKey||n.metaKey)&&l.zoomWithWheel(n)}),document.addEventListener("pointerdown",function(n){n.button===1&&(p.value.cursorClass="grabCursor",l.bind(),l.handleDown(n),n.preventDefault())}),document.addEventListener("pointerup",function(n){n.button===1&&(l.destroy(),console.log("放开了"),p.value.cursorClass="defaultCursor")})}});const r=y({scale:1,isBlack:!1}),k=b(()=>r.isBlack?{bgColor:"transparent",hoverBg:"#fff",hoverColor:"#000",longfgColor:"#BABBBC",fontColor:"#DEDEDE",shadowColor:"#525252",lineColor:"#51d6a9",borderColor:"#B5B5B5"}:{bgColor:"transparent",lineColor:"#51d6a9",lineType:"dashed"}),o=y({thick:20,width:1470,height:800,canvasWidth:1242,canvasHeight:1660,showRuler:!0,palette:k.value,snapsObj:{h:[],v:[]},shadow:{x:0,y:0,width:0,height:0},panzoomOption:g,isShowReferLine:!0,lines:{h:[0,250],v:[0,500]}}),v=b(()=>({width:`${o.width}px`,height:`${o.height}px`})),i=b(()=>Number(r.scale).toFixed(2)),x=b(()=>({width:`${o.canvasWidth}px`,height:`${o.canvasHeight}px`}));return(l,a)=>(w(),_("div",ee,[d("div",te,[a[4]||(a[4]=d("div",{class:"mr10"},"鼠标中键移动画布 ",-1)),d("div",ae," 缩放比:"+j(i.value),1)]),d("div",{class:N(["wrapper",[r.isBlack?"balckwrapper":"whitewrapper"]]),style:B(v.value)},[z(O(q),V({ref_key:"sketchruleRef",ref:p,scale:r.scale,"onUpdate:scale":a[2]||(a[2]=s=>r.scale=s),"lock-line":f.value,"onUpdate:lockLine":a[3]||(a[3]=s=>f.value=s)},o,{"self-handle":!0}),{default:E(()=>[d("div",{class:"container",style:B(x.value)},[z(Y,{shadow:o.shadow,"onUpdate:shadow":a[0]||(a[0]=s=>o.shadow=s),"snaps-obj":o.snapsObj,"onUpdate:snapsObj":a[1]||(a[1]=s=>o.snapsObj=s),scale:r.scale},null,8,["shadow","snaps-obj","scale"])],4)]),btn:E(({reset:s,zoomIn:n,zoomOut:e})=>[d("div",se,[d("button",{onClick:S(s,["stop"])},"还原",8,ne),d("button",{onClick:S(n,["stop"])},"放大",8,oe),d("button",{onClick:S(e,["stop"])},"缩小",8,le)])]),_:1},16,["scale","lock-line"])],6)]))}});export{ce as default};
