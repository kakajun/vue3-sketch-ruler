import{d as I,r as p,p as F,o as b,b as w,e as l,F as D,q as H,l as N,n as S,t as j,f as B,u as L,s as T,_ as J,a as y,i as K,c as m,w as E,m as V,g as z}from"./index-BE41PeK6.js";import{_ as q}from"./style-DUWvs7Y-.js";import{M as A}from"./moveable-w4OXnnpz.js";const Z={class:"container"},G=["id","data-id","data-left","data-top","onMousedown"],Q=!0,X=I({__name:"moveble",props:{scale:{},snapsObj:{},shadow:{}},emits:["update:shadow","update:snapsObj"],setup(O,{emit:i}){const g=i,h=p(null),f=p(null),c={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},_={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},n=p(),r=p([{id:"target0",className:"element0",left:200,top:150,background:"#ee8",width:600,zIndex:1,height:600},{id:"target1",className:"element1",left:600,top:150,zIndex:1,background:"rgb(52, 55, 221)",width:400,height:300},{id:"target2",className:"element2",left:100,top:600,zIndex:1,background:"rgb(212, 67, 152)",width:400,height:400}]),k=(e,d)=>{const t=d.id;r.value.forEach(u=>u.zIndex=1),d.zIndex=2,h.value=t,T(()=>{f.value.dragStart(e)})},x=e=>{n.value=JSON.parse(JSON.stringify(r.value))},o=e=>{let{target:d,translate:t}=e;const{id:u}=d.dataset,{left:$,top:R,width:M,height:P}=n.value.find(C=>C.id==u),[U,W]=t,v=r.value.find(C=>C.id==u);v.left=$+U,v.top=R+W,g("update:shadow",{x:v.left,y:v.top,width:M,height:P})};F(()=>r,()=>{const e=r.value.map(t=>t.top),d=r.value.map(t=>t.left);g("update:snapsObj",{h:e,v:d})},{deep:!0});const a=e=>({left:e.left+"px",top:e.top+"px",lineHeight:e.height+"px",width:e.width+"px",height:e.height+"px",zIndex:e.zIndex,transform:"rotate(0deg)",background:e.background}),s=e=>{f.value.updateRect()};return(e,d)=>(b(),w(D,null,[l("div",Z,[(b(!0),w(D,null,H(r.value,t=>(b(),w("div",{id:t.id,key:t.id,class:N(["target",t.className]),"data-id":t.id,"data-left":t.left,"data-top":t.top,style:S(a(t)),onMousedown:u=>k(u,t)},j(t.className),47,G))),128))]),B(L(A),{ref_key:"moveableRef",ref:f,snappable:!0,"snap-gap":!0,"snap-directions":c,"element-snap-directions":_,"snap-threshold":5/e.scale,target:`#${h.value}`,draggable:Q,"element-guidelines":[".container",".element0",".element1",".element2"],onDrag:o,onDragStart:x,onDragEnd:s},null,8,["snap-threshold","target"])],64))}}),Y=J(X,[["__scopeId","data-v-9639060f"]]),ee={class:"demo"},te={class:"top font16"},ae={class:"scale mr10"},se={class:"btns"},ne=["onClick"],oe=["onClick"],le=["onClick"],ce=I({__name:"moveble",setup(O){const i=p(),g=y({maxScale:3,minScale:.3,disablePan:!1,disableZoom:!1,contain:"none",handleStartEvent:o=>{o.preventDefault(),console.log("handleStartEvent",o)}}),h=p(!1);K(()=>{window.addEventListener("resize",f);const o=i.value.panzoomInstance,a=document.getElementsByClassName("canvasedit-parent");if(a[0]){const s=a[0];s&&s.addEventListener("wheel",function(e){(e.ctrlKey||e.metaKey)&&o.zoomWithWheel(e)}),document.addEventListener("pointerdown",function(e){e.button===1&&(i.value.cursorClass="grabCursor",o.bind(),o.handleDown(e),e.preventDefault())}),document.addEventListener("pointerup",function(e){e.button===1&&(o.destroy(),console.log("放开了"),i.value.cursorClass="defaultCursor")})}});const f=()=>{i.value&&i.value.initPanzoom()},c=y({scale:1,isBlack:!1}),_=m(()=>c.isBlack?{bgColor:"transparent",hoverBg:"#fff",hoverColor:"#000",longfgColor:"#BABBBC",fontColor:"#DEDEDE",shadowColor:"#525252",lineColor:"#51d6a9",borderColor:"#B5B5B5"}:{bgColor:"transparent",lineColor:"#51d6a9",lineType:"dashed"}),n=y({thick:20,width:1470,height:800,canvasWidth:1242,canvasHeight:1660,showRuler:!0,palette:_.value,snapsObj:{h:[],v:[]},shadow:{x:0,y:0,width:0,height:0},panzoomOption:g,isShowReferLine:!0,lines:{h:[0,250],v:[0,500]}}),r=m(()=>({width:`${n.width}px`,height:`${n.height}px`})),k=m(()=>Number(c.scale).toFixed(2)),x=m(()=>({width:`${n.canvasWidth}px`,height:`${n.canvasHeight}px`}));return(o,a)=>(b(),w("div",ee,[l("div",te,[a[4]||(a[4]=l("div",{class:"mr10"},"鼠标中键移动画布 ",-1)),l("div",ae," 缩放比:"+j(k.value),1)]),l("div",{class:N(["wrapper",[c.isBlack?"balckwrapper":"whitewrapper"]]),style:S(r.value)},[B(L(q),V({ref_key:"sketchruleRef",ref:i,scale:c.scale,"onUpdate:scale":a[2]||(a[2]=s=>c.scale=s),"lock-line":h.value,"onUpdate:lockLine":a[3]||(a[3]=s=>h.value=s)},n,{"self-handle":!0}),{default:E(()=>[l("div",{class:"container",style:S(x.value)},[B(Y,{shadow:n.shadow,"onUpdate:shadow":a[0]||(a[0]=s=>n.shadow=s),"snaps-obj":n.snapsObj,"onUpdate:snapsObj":a[1]||(a[1]=s=>n.snapsObj=s),scale:c.scale},null,8,["shadow","snaps-obj","scale"])],4)]),btn:E(({reset:s,zoomIn:e,zoomOut:d})=>[l("div",se,[l("button",{onClick:z(s,["stop"])},"还原",8,ne),l("button",{onClick:z(e,["stop"])},"放大",8,oe),l("button",{onClick:z(d,["stop"])},"缩小",8,le)])]),_:1},16,["scale","lock-line"])],6)]))}});export{ce as default};
