import{d as N,r as h,q as H,b as w,F as E,e as d,f as B,s as P,u as j,o as k,n as z,k as O,t as L,v as T,_ as J,a as y,p as K,c as b,w as I,m as V,g as S}from"./index-UPowV2kH.js";import{o as q}from"./style-DDFHMpJZ.js";import{M as A}from"./moveable-DfBkuZFT.js";const Z={class:"container"},G=["id","data-id","data-left","data-top","onMousedown"],Q=!0,X=N({__name:"moveble",props:{scale:{},snapsObj:{},shadow:{}},emits:["update:shadow","update:snapsObj"],setup(D,{emit:u}){const g=u,f=h(null),r=h(null),_={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},n={top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},v=h(),c=h([{id:"target0",className:"element0",left:200,top:150,background:"#ee8",width:600,zIndex:1,height:600},{id:"target1",className:"element1",left:600,top:150,zIndex:1,background:"rgb(52, 55, 221)",width:400,height:300},{id:"target2",className:"element2",left:100,top:600,zIndex:1,background:"rgb(212, 67, 152)",width:400,height:400}]),x=(e,i)=>{const t=i.id;c.value.forEach(p=>p.zIndex=1),i.zIndex=2,f.value=t,T(()=>{r.value.dragStart(e)})},l=e=>{v.value=JSON.parse(JSON.stringify(c.value))},a=e=>{let{target:i,translate:t}=e;const{id:p}=i.dataset,{left:$,top:R,width:M,height:U}=v.value.find(C=>C.id==p),[W,F]=t,m=c.value.find(C=>C.id==p);m.left=$+W,m.top=R+F,g("update:shadow",{x:m.left,y:m.top,width:M,height:U})};H(()=>c,()=>{const e=c.value.map(t=>t.top),i=c.value.map(t=>t.left);g("update:snapsObj",{h:e,v:i})},{deep:!0});const s=e=>({left:e.left+"px",top:e.top+"px",lineHeight:e.height+"px",width:e.width+"px",height:e.height+"px",zIndex:e.zIndex,transform:"rotate(0deg)",background:e.background}),o=e=>{r.value.updateRect()};return(e,i)=>(k(),w(E,null,[d("div",Z,[(k(!0),w(E,null,P(c.value,t=>(k(),w("div",{id:t.id,key:t.id,class:O(["target",t.className]),"data-id":t.id,"data-left":t.left,"data-top":t.top,style:z(s(t)),onMousedown:p=>x(p,t)},L(t.className),47,G))),128))]),B(j(A),{ref_key:"moveableRef",ref:r,snappable:!0,"snap-gap":!0,"snap-directions":_,"element-snap-directions":n,"snap-threshold":5/D.scale,target:`#${f.value}`,draggable:Q,"element-guidelines":[".container",".element0",".element1",".element2"],onDrag:a,onDragStart:l,onDragEnd:o},null,8,["snap-threshold","target"])],64))}}),Y=J(X,[["__scopeId","data-v-9639060f"]]),ee={class:"demo"},te={class:"top font16"},ae={class:"scale mr10"},se={class:"btns"},oe=["onClick"],ne=["onClick"],le=["onClick"],ie=N({__name:"moveble",setup(D){const u=h(),g=y({maxScale:3,minScale:.3,disablePan:!1,disableZoom:!1,contain:"none",handleStartEvent:l=>{l.preventDefault(),console.log("handleStartEvent",l)}}),f=h(!1);K(()=>{const l=u.value.panzoomInstance,a=document.getElementsByClassName("canvasedit-parent");if(a[0]){const s=a[0];s&&s.addEventListener("wheel",function(o){(o.ctrlKey||o.metaKey)&&l.zoomWithWheel(o)}),document.addEventListener("pointerdown",function(o){o.button===1&&(u.value.cursorClass="grabCursor",l.bind(),l.handleDown(o),o.preventDefault())}),document.addEventListener("pointerup",function(o){o.button===1&&(l.destroy(),console.log("放开了"),u.value.cursorClass="defaultCursor")})}});const r=y({scale:1,isBlack:!1}),_=b(()=>r.isBlack?{bgColor:"transparent",hoverBg:"#fff",hoverColor:"#000",longfgColor:"#BABBBC",fontColor:"#DEDEDE",shadowColor:"#525252",lineColor:"#51d6a9",borderColor:"#B5B5B5"}:{bgColor:"transparent",lineColor:"#51d6a9",lineType:"dashed"}),n=y({thick:20,width:1470,height:800,canvasWidth:1242,canvasHeight:1660,showRuler:!0,palette:_.value,snapsObj:{h:[],v:[]},shadow:{x:0,y:0,width:0,height:0},panzoomOption:g,isShowReferLine:!0,lines:{h:[0,250],v:[0,500]}}),v=b(()=>({width:`${n.width}px`,height:`${n.height}px`})),c=b(()=>Number(r.scale).toFixed(2)),x=b(()=>({width:`${n.canvasWidth}px`,height:`${n.canvasHeight}px`}));return(l,a)=>(k(),w("div",ee,[d("div",te,[a[4]||(a[4]=d("div",{class:"mr10"},"鼠标中键移动画布 ",-1)),d("div",ae," 缩放比:"+L(c.value),1)]),d("div",{class:O(["wrapper",[r.isBlack?"balckwrapper":"whitewrapper"]]),style:z(v.value)},[B(j(q),V({ref_key:"sketchruleRef",ref:u,scale:r.scale,"onUpdate:scale":a[2]||(a[2]=s=>r.scale=s),"lock-line":f.value,"onUpdate:lockLine":a[3]||(a[3]=s=>f.value=s)},n,{"self-handle":!0}),{default:I(()=>[d("div",{class:"container",style:z(x.value)},[B(Y,{shadow:n.shadow,"onUpdate:shadow":a[0]||(a[0]=s=>n.shadow=s),"snaps-obj":n.snapsObj,"onUpdate:snapsObj":a[1]||(a[1]=s=>n.snapsObj=s),scale:r.scale},null,8,["shadow","snaps-obj","scale"])],4)]),btn:I(({reset:s,zoomIn:o,zoomOut:e})=>[d("div",se,[d("button",{onClick:S(s,["stop"])},"还原",8,oe),d("button",{onClick:S(o,["stop"])},"放大",8,ne),d("button",{onClick:S(e,["stop"])},"缩小",8,le)])]),_:1},16,["scale","lock-line"])],6)]))}});export{ie as default};
