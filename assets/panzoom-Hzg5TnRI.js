/*!simple-panzoom v1.0.72024年8月Sat Aug 10 2024 16:04:04 GMT+0800 (中国标准时间)制作*/typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}));function st(e,t){let o=e.length;for(;o--;)if(e[o].pointerId===t.pointerId)return o;return-1}function Q(e,t){let o;if(t.touches){o=0;for(const c of t.touches)c.pointerId=o++,Q(e,c);return}o=st(e,t),o>-1&&e.splice(o,1),e.push(t)}function mt(e,t){if(t.touches){for(;e.length;)e.pop();return}const o=st(e,t);o>-1&&e.splice(o,1)}function rt(e){e=e.slice(0);let t=e.pop(),o;for(;o=e.pop();)t={clientX:(o.clientX-t.clientX)/2+t.clientX,clientY:(o.clientY-t.clientY)/2+t.clientY};return t}function H(e){if(e.length<2)return 0;const t=e[0],o=e[1];return Math.sqrt(Math.pow(Math.abs(o.clientX-t.clientX),2)+Math.pow(Math.abs(o.clientY-t.clientY),2))}let M={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};typeof window<"u"&&(typeof window.PointerEvent=="function"?M={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:typeof window.TouchEvent=="function"&&(M={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));function J(e,t,o,c){M[e].split(" ").forEach(f=>{t.addEventListener(f,o,c)})}function K(e,t,o){M[e].split(" ").forEach(c=>{t.removeEventListener(c,o)})}const ht=typeof document<"u"&&!!document.documentMode;let at;function gt(){return at||(at=document.createElement("div").style)}const it=["webkit","moz","ms"],T={};function tt(e){if(T[e])return T[e];const t=gt();if(e in t)return T[e]=e;const o=e[0].toUpperCase()+e.slice(1);let c=it.length;for(;c--;){const f=`${it[c]}${o}`;if(f in t)return T[e]=f}}function L(e,t){return parseFloat(t[tt(e)])||0}function G(e,t,o=window.getComputedStyle(e)){const c=t==="border"?"Width":"";return{left:L(`${t}Left${c}`,o),right:L(`${t}Right${c}`,o),top:L(`${t}Top${c}`,o),bottom:L(`${t}Bottom${c}`,o)}}function x(e,t,o){e.style[tt(t)]=o}function yt(e,t){const o=tt("transform");x(e,"transition",`${o} ${t.duration}ms ${t.easing}`)}function wt(e,{x:t,y:o,scale:c,isSVG:f},w){if(x(e,"transform",`scale(${c}) translate(${t}px, ${o}px)`),f&&ht){const p=window.getComputedStyle(e).getPropertyValue("transform");e.setAttribute("transform",p)}}function V(e){const t=e.parentNode,o=window.getComputedStyle(e),c=window.getComputedStyle(t),f=e.getBoundingClientRect(),w=t.getBoundingClientRect();return{elem:{style:o,width:f.width,height:f.height,top:f.top,bottom:f.bottom,left:f.left,right:f.right,margin:G(e,"margin",o),border:G(e,"border",o)},parent:{style:c,width:w.width,height:w.height,top:w.top,bottom:w.bottom,left:w.left,right:w.right,padding:G(t,"padding",c),border:G(t,"border",c)}}}function bt(e){let t=e;for(;t&&t.parentNode;){if(t.parentNode===document)return!0;t=t.parentNode instanceof ShadowRoot?t.parentNode.host:t.parentNode}return!1}function vt(e){return(e.getAttribute("class")||"").trim()}function xt(e,t){return e.nodeType===1&&` ${vt(e)} `.indexOf(` ${t} `)>-1}function Et(e,t){for(let o=e;o!=null;o=o.parentNode)if(xt(o,t.excludeClass)||t.exclude.indexOf(o)>-1)return!0;return!1}const St=/^http:[\w\.\/]+svg$/;function Mt(e){return St.test(e.namespaceURI)&&e.nodeName.toLowerCase()!=="svg"}function At(e){const t={};for(const o in e)e.hasOwnProperty(o)&&(t[o]=e[o]);return t}const ct={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:e=>{e.preventDefault(),e.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,pinchAndPan:!1,relative:!1,setTransform:wt,startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};function Pt(e,t){if(!e)throw new Error("Panzoom requires an element as an argument");if(e.nodeType!==1)throw new Error("Panzoom requires an element with a nodeType of 1");if(!bt(e))throw new Error("Panzoom should be called on elements that have been attached to the DOM");t={...ct,...t};const o=Mt(e),c=e.parentNode;c.style.overflow=t.overflow,c.style.userSelect="none",c.style.touchAction=t.touchAction,(t.canvas?c:e).style.cursor=t.cursor,e.style.userSelect="none",e.style.touchAction=t.touchAction,x(e,"transformOrigin",typeof t.origin=="string"?t.origin:o?"0 0":"50% 50%");function f(){c.style.overflow="",c.style.userSelect="",c.style.touchAction="",c.style.cursor="",e.style.cursor="",e.style.userSelect="",e.style.touchAction="",x(e,"transformOrigin","")}function w(n={}){for(const a in n)n.hasOwnProperty(a)&&(t[a]=n[a]);(n.hasOwnProperty("cursor")||n.hasOwnProperty("canvas"))&&(c.style.cursor=e.style.cursor="",(t.canvas?c:e).style.cursor=t.cursor),n.hasOwnProperty("overflow")&&(c.style.overflow=n.overflow),n.hasOwnProperty("touchAction")&&(c.style.touchAction=n.touchAction,e.style.touchAction=n.touchAction)}let p=0,m=0,d=1,A=!1;$(t.startScale,{animate:!1,force:!0}),setTimeout(()=>{W(t.startX,t.startY,{animate:!1,force:!0})});function P(n,a,s){if(s.silent)return;const u=new CustomEvent(n,{detail:a});e.dispatchEvent(u)}function I(n,a,s){const u={x:p,y:m,scale:d,isSVG:o,originalEvent:s,dimsOut:{}};typeof a.animate=="boolean"&&(a.animate?yt(e,a):x(e,"transition","none")),a.setTransform(e,u,a);function r(){const l=V(e);u.dimsOut=l,P(n,u,a),P("panzoomchange",u,a)}return a.animate?setTimeout(()=>{r()},a.duration+50):requestAnimationFrame(()=>{r()}),u}function R(n,a,s,u){const r={...t,...u},l={x:p,y:m,opts:r};if(!r.force&&(r.disablePan||r.panOnlyWhenZoomed&&d===r.startScale))return l;if(n=parseFloat(n),a=parseFloat(a),r.disableXAxis||(l.x=(r.relative?p:0)+n),r.disableYAxis||(l.y=(r.relative?m:0)+a),r.contain){const i=V(e),g=i.elem.width/d,h=i.elem.height/d,E=g*s,S=h*s,b=(E-g)/2,v=(S-h)/2;if(r.contain==="inside"){const U=(-i.elem.margin.left-i.parent.padding.left+b)/s,k=(i.parent.width-E-i.parent.padding.left-i.elem.margin.left-i.parent.border.left-i.parent.border.right+b)/s;l.x=Math.max(Math.min(l.x,k),U);const _=(-i.elem.margin.top-i.parent.padding.top+v)/s,j=(i.parent.height-S-i.parent.padding.top-i.elem.margin.top-i.parent.border.top-i.parent.border.bottom+v)/s;l.y=Math.max(Math.min(l.y,j),_)}else if(r.contain==="outside"){const U=(-(E-i.parent.width)-i.parent.padding.left-i.parent.border.left-i.parent.border.right+b)/s,k=(b-i.parent.padding.left)/s;l.x=Math.max(Math.min(l.x,k),U);const _=(-(S-i.parent.height)-i.parent.padding.top-i.parent.border.top-i.parent.border.bottom+v)/s,j=(v-i.parent.padding.top)/s;l.y=Math.max(Math.min(l.y,j),_)}}return r.roundPixels&&(l.x=Math.round(l.x),l.y=Math.round(l.y)),l}function O(n,a){const s={...t,...a},u={scale:d,opts:s};if(!s.force&&s.disableZoom)return u;let r=t.minScale,l=t.maxScale;if(s.contain){const i=V(e),g=i.elem.width/d,h=i.elem.height/d;if(g>1&&h>1){const E=i.parent.width-i.parent.border.left-i.parent.border.right,S=i.parent.height-i.parent.border.top-i.parent.border.bottom,b=E/g,v=S/h;t.contain==="inside"?l=Math.min(l,b,v):t.contain==="outside"&&(r=Math.max(r,b,v))}}return u.scale=Math.min(Math.max(n,r),l),u}function W(n,a,s,u){const r=R(n,a,d,s);return p!==r.x||m!==r.y?(p=r.x,m=r.y,I("panzoompan",r.opts,u)):{x:p,y:m,scale:d,isSVG:o,originalEvent:u}}function $(n,a,s){const u=O(n,a),r=u.opts;if(!r.force&&r.disableZoom)return;n=u.scale;let l=p,i=m;if(r.focal){const h=r.focal;l=(h.x/n-h.x/d+p*n)/n,i=(h.y/n-h.y/d+m*n)/n}const g=R(l,i,n,{relative:!1,force:!0});return p=g.x,m=g.y,d=n,I("panzoomzoom",r,s)}function et(n,a){const s={...t,animate:!0,...a};return $(d*Math.exp((n?1:-1)*s.step),s)}function lt(n){return et(!0,n)}function ut(n){return et(!1,n)}function Z(n,a,s,u){const r=V(e),l={width:r.parent.width-r.parent.padding.left-r.parent.padding.right-r.parent.border.left-r.parent.border.right,height:r.parent.height-r.parent.padding.top-r.parent.padding.bottom-r.parent.border.top-r.parent.border.bottom};let i=a.clientX-r.parent.left-r.parent.padding.left-r.parent.border.left-r.elem.margin.left,g=a.clientY-r.parent.top-r.parent.padding.top-r.parent.border.top-r.elem.margin.top;o||(i-=r.elem.width/d/2,g-=r.elem.height/d/2);const h={x:i/l.width*(l.width*n),y:g/l.height*(l.height*n)};return $(n,{...s,animate:!1,focal:h},u)}function dt(n,a){n.preventDefault();const s={...t,...a,animate:!1},u=(n.deltaY===0&&n.deltaX?n.deltaX:n.deltaY)<0?1:-1,r=O(d*Math.exp(u*s.step/3),s).scale;return Z(r,n,s,n)}function pt(n){const a={...t,animate:!0,force:!0,...n};d=O(a.startScale,a).scale;const s=R(a.startX,a.startY,d,a);return p=s.x,m=s.y,I("panzoomreset",a)}let z,C,X,Y,nt,N;const y=[];function q(n){if(Et(n.target,t))return;Q(y,n),A=!0,t.handleStartEvent(n),z=p,C=m,P("panzoomstart",{x:p,y:m,scale:d,isSVG:o,originalEvent:n},t);const a=rt(y);X=a.clientX,Y=a.clientY,nt=d,N=H(y)}function B(n){if(!A||z===void 0||C===void 0||X===void 0||Y===void 0)return;Q(y,n);const a=rt(y),s=y.length>1;let u=d;if(s){N===0&&(N=H(y));const r=H(y)-N;u=O(r*t.step/80+nt).scale,Z(u,a,{animate:!1},n)}(!s||t.pinchAndPan)&&W(z+(a.clientX-X)/u,C+(a.clientY-Y)/u,{animate:!1},n)}function D(n){y.length===1&&P("panzoomend",{x:p,y:m,scale:d,isSVG:o,originalEvent:n},t),mt(y,n),A&&(A=!1,z=C=X=Y=void 0)}let F=!1;function ot(){F||(F=!0,J("down",t.canvas?c:e,q),J("move",document,B,{passive:!0}),J("up",document,D,{passive:!0}))}function ft(){F=!1,K("down",t.canvas?c:e,q),K("move",document,B),K("up",document,D)}return t.noBind||ot(),{bind:ot,destroy:ft,eventNames:M,getPan:()=>({x:p,y:m}),getScale:()=>d,getOptions:()=>At(t),handleDown:q,handleMove:B,handleUp:D,pan:W,reset:pt,resetStyle:f,setOptions:w,setStyle:(n,a)=>x(e,n,a),zoom:$,zoomIn:lt,zoomOut:ut,zoomToPoint:Z,zoomWithWheel:dt}}Pt.defaultOptions=ct;export{Pt as C};
